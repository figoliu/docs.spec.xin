<!--
同步影响报告

- 版本更改: 未指定 → 1.0.0
 - 版本更改: 未指定 → 1.0.0 → 1.1.0
 - 修改的原则: （新增）代码质量 → 测试标准 → 用户体验一致性 → 文档中文化要求（新增）→ 性能与资源约束 → 可观测性与治理
- 添加的部分: "约束与性能目标", "开发工作流程与质量门禁"
- 删除的部分: 无
- 需要更新的模板与文件:
	- .specify/templates/plan-template.md — ⚠ 待处理（章程检查节需要反映新的门控条件）
	- .specify/templates/spec-template.md — ⚠ 待处理（成功标准与可测试验收需与章程一致）
	- .specify/templates/tasks-template.md — ⚠ 待处理（任务分类与测试门禁需与章程一致）
	- .specify/templates/checklist-template.md — ⚠ 待处理（检查点可能需要新增性能/UX/文档语言条目）
	- README 或 docs/quickstart.md（如存在）— ⚠ 待处理（需新增中文版本或中文节，示例与错误消息须提供中文）
	- 占位符延迟项:
		- 批准人: FIGO
		- 批准日期: 2025-11-07

说明: 版本号已从 1.0.0 递增到 1.1.0，原因是新增了 "文档中文化要求" 作为正式章程原则；根据语义化版本，这类新增原则/部分应为 MINOR 递增。
-->

# TestProject 项目章程

## 核心原则

### 一、代码质量为先
项目必须产出易读、可维护和可审查的代码。具体要求：

- 所有新提交必须通过静态分析和代码风格检查（例如 linters/formatters），并在 CI 中以自动化形式执行。任何 linter 或格式化规则的变更必须有明确的迁移计划。
- 代码必须有清晰的模块边界和最小公共 API。公共 API 的变更需遵循版本治理与向后兼容声明。
- 代码应避免不必要的复杂性；在设计权衡中优先选择可测试性和可理解性（YAGNI 与 KISS 原则）。

理由：高质量代码降低长期维护成本，提升审查效率与错误定位速度，是实现其他原则（测试、性能、UX） 的基础。

### 二、测试标准（不可协商）
测试覆盖三层：单元测试、契约/集成测试与端到端/验收测试。具体要求：

- 在开发任何功能前应编写与之对应的失败测试（若适用，遵循红-绿-重构）。单元测试必须覆盖关键逻辑分支。
- 所有公共契约（API、事件契约、持久化格式）必须有契约测试，且契约变更需通过明示兼容性评估并记录迁移步骤。
- CI 必须包含自动化测试门禁：在主分支上的合并必须保证所有测试通过；对性能或 UX 相关改动须包含相应的性能回归或可用性测试。

理由：可重复的测试是保证可靠发布与降低回归风险的核心手段。把测试作为可交付物的一部分，能确保功能对用户场景的可验证性。

### 三、用户体验一致性
所有用户可见的交互（CLI、Web、API 响应、文档示例）必须保持一致的体验和错误处理模式：

- 对外 API/CLI 输出格式应标准化（例如：JSON + 可读格式），错误应有结构化字段（code、message、details），并提供明确的恢复建议或文档链接。
- 视觉/行为一致性（适用于前端或 UI 层）需定义并记录在组件/样式指南中。任何不一致必须有明确理由并记录在变更日志中。
- 可用性回归视为与功能缺陷同等严重，关键用户流的验收测试必须通过后方可发布。对 UX 的变更应包含可测量的成功标准（参见 spec-template 的成功标准部分）。

理由：一致的用户体验降低用户认知负担，减少支持成本，并确保团队可以独立验证交付的价值。

### 四、文档语言（强制：中文）
所有对用户或开发者可见的文档必须至少提供中文版本，重要文档应以中文为主要语言并在必要时提供其他语言的对等翻译。具体要求：

- 所有仓库根级别的 README、quickstart、主要 spec（specs/**/spec.md）和运行时指南必须包含中文版本（例如 README.md + README.zh-CN.md 或 README.md 以中文为主）。
- 代码注释与示例片段中出现的用户可见文本（例如错误示例、输出示例）应以中文为首要展示语種，必要时可保留英文原文作为补充。
- 文档变更应与章程中的测试与验收流程一致：对用户流或 API 的文档修改需包含可验证的文档验收场景（例如文档示例在本地运行或 CLI 示例输出符合示例中的中文文本）。
- 对于面向国际用户且必须保留英文的文档，须在仓库中提供明确的翻译策略（谁负责、何时更新、如何校验翻译一致性）。

理由：将中文设为强制文档语言可以保证项目对中文读者（包括维护者与终端用户）的无缝可用性与可审计性，减少跨语言理解错误并提高采纳速度。

### 五、性能与资源约束
性能目标必须在计划阶段被明确并在实现与发布过程中作为门控条件验证：

- 每个重要服务/功能在 plan.md 中应声明性能目标（例如 p95 响应时间、吞吐、内存上限或帧率）。这些目标应作为验收条件的一部分。
- 对性能敏感的更改必须通过基准或负载测试进行验证，且应在 CI 或预发布环境中进行回归检测（关键指标不得退化超过事先定义的阈值）。
- 资源使用（内存、磁盘、网络）有明确上限或预算，任何超出预算的设计必须提供优化或分层偿还计划。

理由：明确的性能与资源约束能防止生产环境退化并帮助团队在早期做出可伸缩的设计决策。

### 六、可观测性、可维护性与治理
系统必须可观测（日志、度量、追踪）并且易于运维与审计：

- 所有关键路径必须产生日志与度量，日志应结构化并包含可追踪的请求/操作标识符。度量应导出到可查询的监控系统并包含 SLO/告警阈值。
- 任何重大设计或契约变更需包含迁移计划、兼容性评估与回滚策略，并在变更前在章程中注册（治理流程）。
- 版本控制与发布策略应遵循语义化版本：MAJOR.MINOR.PATCH。MAJOR 权衡指向后向不兼容变更；MINOR 用于新增且兼容的功能；PATCH 用于措辞、文档和小修复。

理由：可观测性与严明的治理是维持长期健康与快速、安全迭代的保障。

## 约束与性能目标

本节列出常见的跨项目约束（可在具体 plan 中覆盖并替代）：

- 默认性能目标（若 plan 中未定义）：p95 请求延时 < 500ms（后台服务），或按具体域调整。任何不满足该默认目标的功能必须在 plan 中声明并解释原因。
- 默认资源上限：每个进程内存预算 500MB（可调整）；长运维任务需使用分批/流式处理以避免内存爆炸。
- 合规与安全：对敏感数据的处理必须在设计阶段标注并遵守相应法规与加密要求。

## 开发工作流程与质量门禁

- 在开始任何用户故事的实现之前，plan.md 与 spec.md 必须明确验收标准与测试策略。
- 所有 PR 必须附带对应测试或证明测试不适用的理由；涉及契约/API 的变更需附带兼容性说明与迁移步骤。
- CI 门禁最低要求：静态检查通过、单元测试通过、契约/集成测试无严重失败。可选项（性能/UX 验证）应在涉及相关改动时作为强制项加入。

## 治理

章程为仓库不可变的治理基础，变更程序如下：

1. 提议变更（PR）必须包含变更说明、影响范围、兼容性评估与迁移/回滚计划。
2. 若变更为 PATCH（措辞/文档/小改进），由至少一名维护者审阅并在 PR 合并时记录修订理由。
3. 若变更为 MINOR（新增或实质性扩展），需至少两名维护者同意并在合并时记录迁移指南。
4. 若变更为 MAJOR（删除或重新定义原则/范围），需召开治理会议并获得≥多数维护者书面批准，随后在 README 与相关模板中同步更新。

治理执行要点：

- 所有变更都应在变更日志中记录（变更类型、理由、影响的模板/文档）。
- PR 审查模板应包含: 章程合规性检查表、影响范围与测试验证清单。

**版本**: 1.1.0 | **批准日期**: 2025-11-07 | **批准人**: FIGO | **最后修正**: 2025-11-07
